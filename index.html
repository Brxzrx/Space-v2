<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Galaxy Overdrive</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:system-ui}
body{background:#000;overflow:hidden;color:#fff}
canvas{display:block}
.panel{
position:absolute;
top:50%;left:50%;
transform:translate(-50%,-50%);
background:#111;
border:2px solid #444;
padding:25px;
border-radius:12px;
display:none;
min-width:280px;
text-align:center;
}
button{
background:#1f1f1f;
border:2px solid #555;
color:#fff;
padding:10px 20px;
margin:6px;
border-radius:8px;
cursor:pointer;
}
button:hover{background:#333}
.grid{
display:grid;
grid-template-columns:1fr 1fr;
gap:10px;
margin-top:10px;
}
.settingRow{
display:flex;
justify-content:space-between;
margin:8px 0;
}
.topUI{
position:absolute;
top:10px;
left:0;right:0;
display:flex;
justify-content:space-between;
padding:0 15px;
font-size:14px;
}
.shop{
position:absolute;
bottom:10px;
left:50%;
transform:translateX(-50%);
display:flex;
gap:10px;
}
</style>
</head>
<body>

<canvas id="c"></canvas>

<div id="startPanel" class="panel" style="display:block">
<h2>Galaxy Overdrive</h2>
<p id="introText">Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ ÙŠØ­Ø§ÙˆÙ„ÙˆÙ† ÙŠÙ…Ø³ÙƒÙˆÙ†Ùƒ ğŸ˜‚</p>
<div class="grid">
<button onclick="startGame()">Ø§Ø¨Ø¯Ø£</button>
<button onclick="openSettings()">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
<button onclick="window.open('https://wa.me/966537219007')">ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø·ÙˆØ±</button>
<button onclick="toggleLang()">ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ©</button>
</div>
</div>

<div id="settingsPanel" class="panel">
<h3>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>
<div class="settingRow">
<span>Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰</span>
<input type="checkbox" id="musicToggle">
</div>
<div class="settingRow">
<span>ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ù‡ØªØ²Ø§Ø²</span>
<input type="checkbox" id="vibrateToggle">
</div>
<div class="settingRow">
<span>ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø¤Ø«Ø±Ø§Øª</span>
<input type="checkbox" id="fxToggle" checked>
</div>
<button onclick="closeSettings()">Ø±Ø¬ÙˆØ¹</button>
</div>

<div id="upgradePanel" class="panel"></div>

<div class="topUI">
<div id="scoreUI"></div>
<div id="comboUI"></div>
</div>

<div class="shop" id="shop"></div>

<script>
const canvas=document.getElementById("c")
const ctx=canvas.getContext("2d")
function resize(){canvas.width=innerWidth;canvas.height=innerHeight}
resize()
addEventListener("resize",resize)

let lang="ar"
function toggleLang(){lang=lang==="ar"?"en":"ar"}

let game=false
let score=0
let combo=1
let comboTimer=0
let round=1
let gravityMode=false
let lowVision=false
let bossActive=false

let player={
x:canvas.width/2,
y:canvas.height-100,
w:40,h:40,
speed:6,
dashCD:0,
dashTime:0,
color:"#00f2ff",
hp:100,
flash:0
}

let enemies=[]
let bullets=[]
let boss=null

function spawnEnemy(){
let type=Math.random()
let speed=round===1?2.5:1.5+round*0.2
let e={
x:Math.random()*canvas.width,
y:-40,
hp:2+round,
maxHp:2+round,
speed:speed,
zigzag:type>0.5,
hitFlash:0
}
enemies.push(e)
}

function spawnBoss(){
bossActive=true
boss={
x:canvas.width/2,
y:120,
hp:40,
maxHp:40,
phase:1,
patternTimer:0
}
}

function startGame(){
document.getElementById("startPanel").style.display="none"
game=true
loop()
}

function openSettings(){document.getElementById("settingsPanel").style.display="block"}
function closeSettings(){document.getElementById("settingsPanel").style.display="none"}

document.getElementById("musicToggle").addEventListener("change",e=>{
if(e.target.checked)window.open("https://youtu.be/Igp4tIOGGMM?si=1B1BothkcZcI9lWn")
})

addEventListener("keydown",e=>{
if(e.key==="ArrowLeft")player.x-=player.speed
if(e.key==="ArrowRight")player.x+=player.speed
if(e.key==="Shift"&&player.dashCD<=0){
player.dashTime=10
player.dashCD=60
}
})

addEventListener("click",()=>{
if(game)shoot()
})

function shoot(){
bullets.push({x:player.x,y:player.y,spd:8,dmg:1+round*0.2})
}

function update(){
if(Math.random()<0.02)spawnEnemy()

if(round%4===0){
enemies.forEach(e=>e.hp+=3)
}

if(round%3===0&&!bossActive)spawnBoss()

if(player.dashCD>0)player.dashCD--
if(player.dashTime>0){
player.x+=15*(Math.random()>0.5?1:-1)
player.dashTime--
}

enemies.forEach(e=>{
e.y+=e.speed
if(e.zigzag)e.x+=Math.sin(e.y*0.05)*2
})

bullets.forEach(b=>b.y-=b.spd)

bullets.forEach(b=>{
enemies.forEach(e=>{
if(Math.abs(b.x-e.x)<20&&Math.abs(b.y-e.y)<20){
e.hp-=b.dmg
e.hitFlash=5
comboTimer=120
combo+=0.2
score+=10*combo
}
})
})

enemies=enemies.filter(e=>{
if(e.hp<=0)return false
if(e.y>canvas.height)return false
return true
})

if(comboTimer>0)comboTimer--
else combo=1

if(score>round*200){
round++
gravityMode=round%5===0
lowVision=round%6===0
showUpgrade()
}
}

function showUpgrade(){
game=false
let panel=document.getElementById("upgradePanel")
panel.innerHTML="<h3>Ø§Ø®ØªØ± ØªØ·ÙˆÙŠØ±</h3>"
let opts=[
{t:"Ø²ÙŠØ§Ø¯Ø© Ø³Ø±Ø¹Ø©",f:()=>player.speed+=1},
{t:"Ø²ÙŠØ§Ø¯Ø© Ø¶Ø±Ø±",f:()=>{}},
{t:"Ø§Ø³ØªØ¹Ø§Ø¯Ø© ØµØ­Ø©",f:()=>player.hp=100}
]
opts.forEach(o=>{
let b=document.createElement("button")
b.innerText=o.t
b.onclick=()=>{o.f();panel.style.display="none";game=true}
panel.appendChild(b)
})
panel.style.display="block"
}

function draw(){
ctx.fillStyle="#000"
ctx.fillRect(0,0,canvas.width,canvas.height)

if(lowVision){
ctx.fillStyle="rgba(0,0,0,0.8)"
ctx.fillRect(0,0,canvas.width,canvas.height)
ctx.clearRect(player.x-100,player.y-100,200,200)
}

ctx.fillStyle=player.flash>0?"#fff":player.color
ctx.fillRect(player.x-20,player.y-20,40,40)
if(player.flash>0)player.flash--

enemies.forEach(e=>{
ctx.fillStyle=e.hitFlash>0?"#fff":"#ff4444"
ctx.fillRect(e.x-20,e.y-20,40,40)
if(e.hitFlash>0)e.hitFlash--
ctx.fillStyle="#0f0"
ctx.fillRect(e.x-20,e.y-30,40*(e.hp/e.maxHp),4)
})

bullets.forEach(b=>{
ctx.fillStyle="#ffff00"
ctx.fillRect(b.x-3,b.y-10,6,10)
})

if(bossActive){
ctx.fillStyle="#9900ff"
ctx.fillRect(boss.x-60,boss.y-60,120,120)
ctx.fillStyle="#0f0"
ctx.fillRect(boss.x-60,boss.y-80,120*(boss.hp/boss.maxHp),6)
}

document.getElementById("scoreUI").innerText="Score "+Math.floor(score)+" | Round "+round
document.getElementById("comboUI").innerText="Combo x"+combo.toFixed(1)
}

function loop(){
if(!game){draw();requestAnimationFrame(loop);return}
update()
draw()
requestAnimationFrame(loop)
}

setInterval(()=>{
if(!game){
let txts=[
"Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ ÙŠØªØ²Ø­Ù„Ù‚ÙˆÙ† ğŸ˜‚",
"ÙˆØ§Ø­Ø¯ Ø·Ø§Ø­ Ù…Ù† Ø§Ù„Ø³Ø±Ø¹Ø© ğŸ˜†",
"Ù‚Ø§Ø¦Ø¯Ù‡Ù… Ø¶Ø§ÙŠØ¹ ğŸ‘€"
]
document.getElementById("introText").innerText=txts[Math.floor(Math.random()*txts.length)]
}
},2000)
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Galaxy Overdrive</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:system-ui}
body{background:radial-gradient(circle at 50% 20%,#111 0%,#000 60%);overflow:hidden;color:#fff}
canvas{display:block}
.panel{
position:absolute;top:50%;left:50%;
transform:translate(-50%,-50%);
background:linear-gradient(180deg,#151515,#0b0b0b);
border:2px solid #333;padding:25px;border-radius:14px;
display:none;min-width:300px;text-align:center;
box-shadow:0 0 40px #000;
}
.panel h2{margin-bottom:10px}
button{
background:#1a1a1a;border:2px solid #444;color:#fff;
padding:10px 18px;margin:6px;border-radius:10px;cursor:pointer;
}
button:hover{background:#2a2a2a}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
.topUI{
position:absolute;top:10px;left:0;right:0;
display:flex;justify-content:space-between;padding:0 15px;font-size:14px
}
.shop{
position:absolute;bottom:15px;left:50%;
transform:translateX(-50%);display:flex;gap:10px
}
select,input{background:#111;color:#fff;border:1px solid #444;padding:4px}
</style>
</head>
<body>

<canvas id="c"></canvas>

<div id="startPanel" class="panel" style="display:block">
<h2>Galaxy Overdrive</h2>
<p id="introText">استعد للانطلاق</p>
<div class="grid">
<button onclick="startGame()">ابدأ</button>
<button onclick="openSettings()">الإعدادات</button>
<button onclick="window.open('https://wa.me/966537219007')">تواصل مع المطور</button>
<button onclick="openShop()">المتجر</button>
</div>
</div>

<div id="settingsPanel" class="panel">
<h2>الإعدادات</h2>
<div style="margin:8px 0">
<label>اللغة</label>
<select id="langSelect">
<option value="ar">عربي</option>
<option value="en">English</option>
</select>
</div>
<div style="margin:8px 0">
<label>الموسيقى</label>
<input type="checkbox" id="musicToggle">
</div>
<div style="margin:8px 0">
<label>المؤثرات</label>
<input type="checkbox" id="fxToggle" checked>
</div>
<button onclick="closeSettings()">رجوع</button>
</div>

<div id="shopPanel" class="panel">
<h2>المتجر</h2>
<p id="coinUI"></p>
<button onclick="buy('speed')">زيادة سرعة - 100</button>
<button onclick="buy('damage')">زيادة ضرر - 150</button>
<button onclick="buy('skin')">تغيير شكل - 200</button>
<br>
<button onclick="closeShop()">رجوع</button>
</div>

<div class="topUI">
<div id="scoreUI"></div>
<div>
<button onclick="pauseGame()">إيقاف</button>
</div>
</div>

<script>
const canvas=document.getElementById("c")
const ctx=canvas.getContext("2d")
function resize(){canvas.width=innerWidth;canvas.height=innerHeight}
resize()
addEventListener("resize",resize)

let game=false
let paused=false
let score=0
let coins=0
let round=1
let lang="ar"

let player={
x:canvas.width/2,y:canvas.height-120,
r:22,speed:5,hp:100,
color:"#00f2ff",damage:1
}

let enemies=[]
let bullets=[]
let particles=[]

function spawnEnemy(){
enemies.push({
x:Math.random()*canvas.width,
y:-40,
r:20,
hp:3+round,
maxHp:3+round,
speed:1.2+round*0.1,
color:"#ff3c3c"
})
}

function startGame(){
document.getElementById("startPanel").style.display="none"
game=true
loop()
}

function pauseGame(){
game=false
document.getElementById("startPanel").style.display="block"
}

function openSettings(){document.getElementById("settingsPanel").style.display="block"}
function closeSettings(){document.getElementById("settingsPanel").style.display="none"}
function openShop(){document.getElementById("shopPanel").style.display="block"}
function closeShop(){document.getElementById("shopPanel").style.display="none"}

document.getElementById("langSelect").addEventListener("change",e=>{
lang=e.target.value
if(lang==="en"){
document.documentElement.lang="en"
document.documentElement.dir="ltr"
}else{
document.documentElement.lang="ar"
document.documentElement.dir="rtl"
}
})

document.getElementById("musicToggle").addEventListener("change",e=>{
if(e.target.checked)window.open("https://youtu.be/Igp4tIOGGMM?si=1B1BothkcZcI9lWn")
})

canvas.addEventListener("touchmove",e=>{
let rect=canvas.getBoundingClientRect()
let t=e.touches[0]
player.x=t.clientX-rect.left
player.y=t.clientY-rect.top
})

canvas.addEventListener("click",shoot)

function shoot(){
bullets.push({x:player.x,y:player.y,spd:8,dmg:player.damage})
}

function buy(type){
if(type==="speed"&&coins>=100){coins-=100;player.speed+=1}
if(type==="damage"&&coins>=150){coins-=150;player.damage+=0.5}
if(type==="skin"&&coins>=200){coins-=200;player.color="#"+Math.floor(Math.random()*16777215).toString(16)}
}

function update(){
if(Math.random()<0.02)spawnEnemy()

enemies.forEach(e=>e.y+=e.speed)

bullets.forEach(b=>b.y-=b.spd)

bullets.forEach(b=>{
enemies.forEach(e=>{
if(Math.hypot(b.x-e.x,b.y-e.y)<e.r){
e.hp-=b.dmg
spawnExplosion(e.x,e.y)
}
})
})

enemies=enemies.filter(e=>{
if(e.hp<=0){score+=10;coins+=5;return false}
if(e.y>canvas.height)return false
return true
})

particles.forEach(p=>p.life--)
particles=particles.filter(p=>p.life>0)

if(score>round*200)round++
}

function spawnExplosion(x,y){
for(let i=0;i<20;i++){
particles.push({
x:x,y:y,
vx:(Math.random()-0.5)*4,
vy:(Math.random()-0.5)*4,
life:40
})
}
}

function draw(){
ctx.clearRect(0,0,canvas.width,canvas.height)

particles.forEach(p=>{
ctx.fillStyle="rgba(255,200,0,"+(p.life/40)+")"
ctx.fillRect(p.x,p.y,4,4)
p.x+=p.vx
p.y+=p.vy
})

ctx.fillStyle=player.color
ctx.beginPath()
ctx.arc(player.x,player.y,player.r,0,Math.PI*2)
ctx.fill()

enemies.forEach(e=>{
ctx.fillStyle=e.color
ctx.beginPath()
ctx.arc(e.x,e.y,e.r,0,Math.PI*2)
ctx.fill()

ctx.fillStyle="#0f0"
ctx.fillRect(e.x-20,e.y-30,40*(e.hp/e.maxHp),4)
})

bullets.forEach(b=>{
ctx.fillStyle="#fff"
ctx.fillRect(b.x-2,b.y-10,4,10)
})

document.getElementById("scoreUI").innerText="Score "+score+" | Coins "+coins+" | Round "+round
document.getElementById("coinUI").innerText="Coins "+coins
}

function loop(){
if(!game)return
update()
draw()
requestAnimationFrame(loop)
}
</script>
</body>
</html>
